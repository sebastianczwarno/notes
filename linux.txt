# debian latest firefox:
cd ~/Downloads && wget -O firefox.tar.bz2 --content-disposition 'https://download.mozilla.org/?product=firefox-latest-ssl&os=linux64&lang=en-US' && tar -xf firefox.tar.bz2 && sudo mv firefox /opt/ && sudo chmod 775 /opt/firefox && sudo chmod 775 /opt/firefox/firefox && sudo chown -R $USER /opt/firefox && 
echo '[Desktop Entry]
Name=Firefox
Comment=Web Browser
Exec=/opt/firefox/firefox %u
Terminal=false
Type=Application
Icon=/opt/firefox/browser/chrome/icons/default/default128.png
Categories=Network;WebBrowser;
MimeType=text/html;text/xml;application/xhtml+xml;application/xml;application/vnd.mozilla.xul+xml;application/rss+xml;application/rdf+xml;image/gif;image/jpeg;image/png;x-scheme-handler/http;x-scheme-handler/https;
StartupNotify=true
Actions=Private;
StartupWMClass=firefox

[Desktop Action Private]
Exec=/opt/firefox/firefox --private-window %u
Name=Open in private mode' >> firefox.desktop && sudo mv firefox.desktop /usr/share/applications/ && sudo ln -s /opt/firefox/firefox /usr/bin/firefox


#dotnet
wget https://packages.microsoft.com/config/debian/11/packages-microsoft-prod.deb -O packages-microsoft-prod.deb && \
sudo apt install ./packages-microsoft-prod.deb && sudo apt-get update; \
sudo apt-get install -y apt-transport-https && \
sudo apt-get update && \
sudo apt-get install -y dotnet-sdk-6.0

#rider/idea
wget https://download.jetbrains.com/rider/JetBrains.Rider-2021.3.3.tar.gz && tar -xf JetBrains.Rider-2021.3.3.tar.gz && \
mv 'JetBrains Rider-2021.3.3' rider && sudo mv rider /opt/ && sudo chmod 775 /opt/rider/ && \
sudo chown -R $USER /opt/rider/ && sudo chown -R $USER /opt/rider/bin/ && sudo chmod 775 /opt/rider/bin/rider.sh && \
sudo ln -s /opt/rider/bin/rider.sh /usr/bin/rider

# Hardware acceleration
sudo apt install libavcodec-extra \
  ttf-mscorefonts-installer       \
  unrar                           \
  gstreamer1.0-libav              \
  gstreamer1.0-plugins-ugly       \
  gstreamer1.0-vaapi;
  
sudo apt install intel-gpu-tools
  
# To enable the feature on xorg append:
export MOZ_X11_EGL=1 to /etc/environment

# To enable the feature on wayland append (not needed on 21.04):
sudo sh -c "echo 'export MOZ_ENABLE_WAYLAND=1' >> /etc/environment"


#Settings:
Navigate to about:config in Firefox and set the following flags:
media.ffmpeg.vaapi.enabled to true. Enables the feature.
media.ffvpx.enabled to false. Disables the internal software decoders for VP8/VP9, which currently overrule hardware accelerated video.
media.rdd-vpx.enabled to false. Needed due to Firefox trying to put some video decoding in a remote video process 46. This currently breaks accelerated VP8/VP9 video decoding.
media.navigator.mediadatadecoder_vpx_enabled to true. Enables hardware decoding for WebRTC, which is used on web based video conferencing apps.

# Verification under about:support
Compositing: WebRender
Window Protocol: wayland
# under terminal
sudo apt install intel-gpu-tools && sudo intel_gpu_top
